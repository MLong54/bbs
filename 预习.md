论坛功能
--------

1. 上传头像
2. 私信和AT
3. 邮件
    - 通知
    - 重置密码
4. 导航栏和 jinja2 模板继承



上传头像
--------
1. form
2. post 方法 对应一个路由 保存静态文件的功能
    1. 文件后缀要做过滤 img png gif
    2. 文件名也要小心
      ../../home/akirayu/.bash_rc -> xxxxxx
      ~/.bash_rc
      ~/.bash_profile
3. get 方法，本地的静态文件转发给用户


发私信 数据结构
--------------
1. id
2. content
3. title
4. sender_id # 这个不应该是从表单里面拿的，伪造成任何人
5. receiver_id

AT
--
1. 拿到内容
2. 从内容中提取出 at 的所有用户
3. 给这些用户发私信


邮件通知
--------

- 开 25 端口 ufw 云服务器
- 日志在 /var/log/mail.log
- 注意看垃圾箱

密码找回
--------

- 存 token->user_id 映射关系
- 往 user_id 对应的 email 发邮件，邮件里面带上 token
- 用户点击 url （即发 token），就让用户修改这个 token 对应的 user_id 的密码

部署
----

- nginx
  - web 服务器
  - 反向代理
    - 2000 -> 80
  - 静态文件托管
    - send_by_directory 每次都 send 很不好
    - 配置了一个规则，保存在 nginx 的缓存，不会走到 app 这一层
- gunicorn: 
  - 应用服务器
  - 负载均衡 gunicorn worker
- wsgi: 
  - 协议
  - 包装出来一个app
- request -> nginx -> gunicorn -> wsgi -> app(Flask) -> route
